import{d as O,k as S,r as f,D as E,z as j,a as c,c as _,w as t,b as o,q as L,e as Z,l as $,F as z,H as G,Z as d,I as H,J,g as K,aq as P,T as R,K as W,M as Q}from"./index-7c55f663.js";import{a as X,u as Y}from"./index-e8d44f57.js";/* empty css              *//* empty css              */import{x as ee,A as le}from"./index-5f419692.js";/* empty css              */import{j as ae,k as oe}from"./Basic-bc49e0e2.js";import{g as se}from"./index2-1beec9a6.js";const fe=O({__name:"UserEditDialog",props:{visible:{type:Boolean},formData:{}},emits:["done","update:visible"],setup(U,{emit:y}){const u=U,b=S({get(){return console.log("获取User子组件："+u.visible),u.visible},set(s){console.log("设置User子组件："+u.visible),y("update:visible",s)}}),i=f(),m=f(!1),v={userId:0,userName:"",nickname:"",phoneMobileNumber:"",phoneTeleNumber:"",emailAddress:"",roleIds:[],gender:0,birthday:"",isDisable:!1},a=E({...v}),N=f({userName:[{type:"string",required:!0,message:"账号不能为空"},{asyncValidator:async(s,e)=>{if(!e)return Promise.resolve()}}],warehouseId:{type:"number",required:!0,message:"请选择仓库",validator(s,e,r,n,w){e<=0&&r(new Error("请选择仓库"))}},email:{type:"email"}}),g=f([]);async function k(){const s=await ae();if(!s||!s.isSuccess){d.msg((s==null?void 0:s.message)||"获取角色失败",{icon:2});return}g.value=s.responseData.map(e=>({label:e.roleName,value:e.roleId}))}function I(){k(),u.formData?(Object.assign(a,u.formData),m.value=!0,u.formData.roleInfos&&(a.roleIds=u.formData.roleInfos.map(s=>s.roleId))):(Object.assign(a,v),m.value=!1)}j(()=>u.visible,(s,e)=>{console.log("visible变化：",s,e),s&&I()});function V(){var s;b.value=!1,i.value.reset(),(s=i.value)==null||s.clearValidate()}async function x(s,e){try{const r=await oe(s);if(!r||!r.isSuccess){d.confirm(r.message||"编辑用户信息失败",{icon:2});return}d.msg(r.message||"操作成功",{icon:1}),y("done"),V()}catch(r){d.msg(r.message,{icon:2})}finally{d.close(e)}}function q(){i.value.validate((s,e,r)=>{s&&d.msg("正在提交数据...",{icon:16,time:0,shade:!0,success:async n=>{await x(e,n)}})})}return(s,e)=>{const r=H,n=J,w=K,T=P,h=ee,A=le,D=X,p=se,B=R,C=Y,F=W,M=Q;return c(),_(M,{modelValue:b.value,"onUpdate:modelValue":e[12]||(e[12]=l=>b.value=l),area:"700px",title:m.value?"编辑":"新增","shade-close":!1,move:!0,maxmin:!0,btn:[{text:"提交",callback:()=>q()},{text:"关闭",callback:()=>V()}],onClose:V},{default:t(()=>[o(F,{ref_key:"refForm",ref:i,model:a,rules:N.value,style:{padding:"10px"}},{default:t(()=>[o(C,null,{default:t(()=>[o(D,{md:12},{default:t(()=>[o(n,{label:"账号",prop:"userName",required:""},{default:t(()=>[o(r,{modelValue:a.userName,"onUpdate:modelValue":e[0]||(e[0]=l=>a.userName=l),placeholder:"请填写",disabled:m.value,"allow-clear":""},null,8,["modelValue","disabled"])]),_:1}),o(n,{label:"昵称",prop:"nickname",required:""},{default:t(()=>[o(r,{modelValue:a.nickname,"onUpdate:modelValue":e[1]||(e[1]=l=>a.nickname=l),placeholder:"请填写","allow-clear":"",autocomplete:"off"},null,8,["modelValue"])]),_:1}),m.value?L("",!0):(c(),_(n,{key:0,label:"密码",prop:"password",rules:[{type:"string",required:!0,message:"密码不能为空"},{type:"string",min:6,max:10,message:"密码长度6-10"}],required:""},{default:t(()=>[o(r,{modelValue:a.password,"onUpdate:modelValue":e[2]||(e[2]=l=>a.password=l),type:"password",placeholder:"请填写",password:"","allow-clear":"",autocomplete:"off"},null,8,["modelValue"])]),_:1})),o(n,{label:"邮箱",prop:"emailAddress"},{default:t(()=>[o(r,{modelValue:a.emailAddress,"onUpdate:modelValue":e[3]||(e[3]=l=>a.emailAddress=l),placeholder:"请填写","allow-clear":""},null,8,["modelValue"])]),_:1}),o(n,{prop:"roleIds"},{label:t(()=>[Z(" 角色 "),o(T,{content:"不选则解绑该用户原有的角色"},{default:t(()=>[o(w,{type:"layui-icon-about"})]),_:1})]),default:t(()=>[o(A,{modelValue:a.roleIds,"onUpdate:modelValue":e[4]||(e[4]=l=>a.roleIds=l),placeholder:"请选择",multiple:"","allow-clear":"","min-collapsed-num":1,style:{width:"100%"}},{default:t(()=>[(c(!0),$(z,null,G(g.value,l=>(c(),_(h,{key:l.value,value:l.value,label:l.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),o(D,{md:12},{default:t(()=>[o(n,{label:"性别",prop:"gender",required:""},{default:t(()=>[o(p,{modelValue:a.gender,"onUpdate:modelValue":e[5]||(e[5]=l=>a.gender=l),name:"gender",value:1,label:"男"},null,8,["modelValue"]),o(p,{modelValue:a.gender,"onUpdate:modelValue":e[6]||(e[6]=l=>a.gender=l),name:"gender",value:0,label:"女"},null,8,["modelValue"])]),_:1}),o(n,{label:"是否禁用",prop:"isDisable"},{default:t(()=>[o(p,{modelValue:a.isDisable,"onUpdate:modelValue":e[7]||(e[7]=l=>a.isDisable=l),name:"isDisable",value:!0,label:"是"},null,8,["modelValue"]),o(p,{modelValue:a.isDisable,"onUpdate:modelValue":e[8]||(e[8]=l=>a.isDisable=l),name:"isDisable",value:!1,label:"否"},null,8,["modelValue"])]),_:1}),o(n,{label:"手机号码",prop:"phoneMobileNumber"},{default:t(()=>[o(r,{modelValue:a.phoneMobileNumber,"onUpdate:modelValue":e[9]||(e[9]=l=>a.phoneMobileNumber=l),placeholder:"请填写","allow-clear":""},null,8,["modelValue"])]),_:1}),o(n,{label:"电话号码",prop:"phoneTeleNumber"},{default:t(()=>[o(r,{modelValue:a.phoneTeleNumber,"onUpdate:modelValue":e[10]||(e[10]=l=>a.phoneTeleNumber=l),placeholder:"请填写","allow-clear":""},null,8,["modelValue"])]),_:1}),o(n,{label:"生日",prop:"birthday"},{default:t(()=>[o(B,{modelValue:a.birthday,"onUpdate:modelValue":e[11]||(e[11]=l=>a.birthday=l),placeholder:"请选择","allow-clear":"",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title","btn"])}}});export{fe as _};
