import{r as U}from"./index-87b27c93.js";import{d as G,C as K,B as V,r as l,D as Z,E as S,a as r,c as n,w as a,b as m,t as _,G as i,e as d,Z as c,A}from"./index-7492a36a.js";import{x as j}from"./index-9192823c.js";import{_ as q}from"./index-9f5117eb.js";import{u as H}from"./useConfirm-bb8840b4.js";import{_ as J}from"./RoleEditDialog.vue_vue_type_script_setup_true_lang-4f2c4077.js";import{_ as O}from"./RoleMenuEdit.vue_vue_type_script_setup_true_lang-fdbe108b.js";import P from"./RoleSearchForm-787a2b7c.js";import{h as Q,i as W}from"./Basic-b53b3ec4.js";import"./index2-7103a362.js";import"./index2-6c497dfa.js";import"./index-52c9049b.js";import"./index2-345a5c0c.js";import"./index2-27793e30.js";import"./index2-046ebce0.js";const X=[{title:"",type:"checkbox",width:"50px",fixed:"left"},{key:"roleId",title:"角色Id",align:"center"},{key:"roleName",title:"角色名",align:"center"},{key:"operator",title:"操作",align:"center",width:"180px",customSlot:"operator",fixed:"right"}],ye=G({__name:"index",setup(Y){var $;const{loading:E,setLoading:p}=K(!0),w=(($=V().meta)==null?void 0:$.title)||"",k=l(),g=l([]),b=l([]),M=l(["filter"]),v=l(!1),y=l(!1),x=l(),C=l(0),h=Z({roleId:0,roleName:""}),I=l([]);p(!1);async function f(){p(!0);try{const t=await Q(h);if(!t||!t.isSuccess){c.msg(t.message||"查询信息失败！");return}g.value=t.responseData}catch{}finally{p(!1)}}function D(t){x.value=t,v.value=!0}function R(t){C.value=t.roleId,I.value=t.menuIds,y.value=!0}function B(t){if(!t){c.msg("请选择角色",{icon:2});return}H("确定要删除这条数据吗？",async o=>{try{const e=await W(t.roleId);if(!e||!e.isSuccess){c.msg((e==null?void 0:e.message)||"操作失败",{icon:2});return}c.msg((e==null?void 0:e.message)||"操作成功",{icon:1}),f(),c.close(o)}catch(e){c.msg(e.message,{icon:2})}})}return(t,o)=>{const e=A,F=q,N=j,L=U,u=S("any-permission"),T=S("permission");return r(),n(L,{fluid:"true",class:"z-container"},{default:a(()=>[m(N,{title:_(w)},{default:a(()=>[m(P,{ref_key:"searchForm",ref:k,"form-data":h},null,8,["form-data"]),m(F,{id:"id","selected-keys":b.value,"onUpdate:selectedKeys":o[3]||(o[3]=s=>b.value=s),loading:_(E),columns:_(X),"data-source":g.value,"default-toolbar":M.value,"max-height":"450px"},{toolbar:a(()=>[i((r(),n(e,{size:"md",type:"normal",onClick:o[0]||(o[0]=s=>f())},{default:a(()=>[d(" 查询 ")]),_:1})),[[u,["sys:role:add","sys:role:save"]]]),i((r(),n(e,{size:"md",onClick:o[1]||(o[1]=s=>k.value.resetForm()),border:"blue"},{default:a(()=>[d(" 重置表单 ")]),_:1})),[[u,["sys:role:add","sys:role:save"]]]),i((r(),n(e,{size:"sm",type:"primary",onClick:o[2]||(o[2]=s=>D())},{default:a(()=>[d(" 新增 ")]),_:1})),[[u,["sys:role:add","sys:role:save"]]])]),operator:a(({row:s})=>[i((r(),n(e,{size:"xs",type:"primary",onClick:z=>D(s)},{default:a(()=>[d(" 修改 ")]),_:2},1032,["onClick"])),[[u,["sys:role:edit","sys:role:update"]]]),i((r(),n(e,{size:"xs",type:"danger",onClick:z=>B(s)},{default:a(()=>[d(" 删除 ")]),_:2},1032,["onClick"])),[[T,"sys:role:delete"]]),i((r(),n(e,{size:"xs",type:"normal",onClick:z=>R(s)},{default:a(()=>[d(" 分配权限 ")]),_:2},1032,["onClick"])),[[u,["sys:role:edit","sys:role:update"]]])]),_:1},8,["selected-keys","loading","columns","data-source","default-toolbar"])]),_:1},8,["title"]),m(J,{visible:v.value,"onUpdate:visible":o[4]||(o[4]=s=>v.value=s),"form-data":x.value,onDone:f},null,8,["visible","form-data"]),m(O,{visible:y.value,"onUpdate:visible":o[5]||(o[5]=s=>y.value=s),"role-id":C.value,"checked-menu-ids":I.value,onDone:f},null,8,["visible","role-id","checked-menu-ids"])]),_:1})}}});export{ye as default};
