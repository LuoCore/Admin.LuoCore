import{r as G}from"./index-18f2e450.js";import{d as K,B as Q,C as q,r,o as W,E as z,a as o,c as i,w as s,b as k,t as b,G as c,e as l,x,f as j,q as F,a1 as J,S as u,a2 as O,A as P,g as R}from"./index-53adf29b.js";import{x as X}from"./index-f2193864.js";import{_ as Y}from"./index-e2d03d9a.js";/* empty css              */import{u as Z}from"./useConfirm-a852b310.js";import ee from"./MenuEditDialogs-796afb9b.js";import{$ as te}from"./index2-79d7d27b.js";import"./index2-5d5b79b3.js";import"./index2-21289748.js";import"./index-c9fd804e.js";/* empty css              *//* empty css              */import"./index-afe1d6ba.js";import"./index2-31d7a95a.js";import"./index2-3ad2494b.js";const se=[{key:"menuId",title:"菜单Id"},{key:"menuName",title:"菜单名称",customSlot:"menuName"},{key:"menuUrl",title:"路由地址",ellipsisTooltip:!0},{key:"sortId",title:"排序",width:"80px",align:"center"},{key:"menuType",title:"类型",width:"150px",align:"center",customSlot:"menuType"},{key:"isDisable",title:"是否禁用",width:"50px",align:"center",customSlot:"isDisable"},{key:"operator",title:"操作",align:"left",customSlot:"operator",fixed:"right",width:"200px"}],xe=K({__name:"index",setup(ne){var T;const{loading:M,setLoading:y}=Q(!0),$=((T=q().meta)==null?void 0:T.title)||"",h=r([]),D=r([]),m=r(!1),E=r(["filter"]),f=r(!1),_=r(),C=r(),I=r(window.innerHeight-300);W(()=>{window.addEventListener("resize",B)});function B(){I.value=window.innerHeight-300}y(!1);async function v(){y(!0);try{const n=await J();if(!n||!n.isSuccess)return;h.value=n.responseData}catch(n){console.log(n)}finally{y(!1)}}function g(n,t){C.value=n,n?_.value={menuId:0,parentId:(t==null?void 0:t.menuId)||0,menuName:"",menuIcon:"",menuUrl:"",sortId:0,menuType:0,isDisable:!1,childrenMenus:[]}:_.value=t,f.value=!0}function H(n){if(!n){u.msg("请选择菜单",{icon:2});return}Z("确定要删除这条数据吗？",async t=>{try{u.msg("正在删除数据...",{icon:16,time:0,shade:!0,success:async a=>{var d=await O(n);d.isSuccess?(u.msg("操作成功",{icon:1}),v()):u.msg("操作失败！"+(d==null?void 0:d.message),{icon:2}),u.close(a)}})}catch(a){u.msg(a.message,{icon:2})}u.close(t)})}function U(){m.value=!m.value}return(n,t)=>{const a=P,d=R,S=te,L=Y,V=X,A=G,p=z("any-permission"),w=z("permission");return o(),i(A,{fluid:"true",class:"z-container"},{default:s(()=>[k(V,{title:b($)},{default:s(()=>[k(L,{id:"menuId","selected-keys":D.value,"onUpdate:selectedKeys":t[2]||(t[2]=e=>D.value=e),"children-column-name":"childrenMenus",height:`${I.value}px`,"default-expand-all":m.value,loading:b(M),columns:b(se),"data-source":h.value,"default-toolbar":E.value,"expand-index":1},{toolbar:s(()=>[c((o(),i(a,{size:"lg",type:"normal",onClick:t[0]||(t[0]=e=>v())},{default:s(()=>[l(" 查询 ")]),_:1})),[[p,["sys:user:add","sys:user:save"]]]),c((o(),i(a,{size:"lg",type:"primary",onClick:t[1]||(t[1]=e=>g(!1))},{default:s(()=>[l(" 新增 ")]),_:1})),[[p,["sys:user:add","sys:user:save"]]]),c((o(),i(a,{size:"md",type:"danger",onClick:U},{default:s(()=>[l(x(m.value?"全部收起":"全部展开"),1)]),_:1})),[[w,"sys:user:delete"]])]),operator:s(({row:e})=>[c((o(),i(a,{size:"sm",type:"primary",onClick:N=>g(!0,e)},{default:s(()=>[l(" 新增子级 ")]),_:2},1032,["onClick"])),[[p,["sys:user:add","sys:user:save"]]]),c((o(),i(a,{size:"sm",onClick:N=>g(!1,e)},{default:s(()=>[l(" 修改 ")]),_:2},1032,["onClick"])),[[p,["sys:user:edit","sys:user:update"]]]),c((o(),i(a,{size:"sm",type:"danger",onClick:N=>H(e.menuId)},{default:s(()=>[l(" 删除 ")]),_:2},1032,["onClick"])),[[w,"sys:user:delete"]])]),menuName:s(({row:e})=>[j("span",null,[e.menuIcon?(o(),i(d,{key:0,type:e.menuIcon,style:{"margin-right":"4px"}},null,8,["type"])):F("",!0),l(" "+x(e.menuName),1)])]),isDisable:s(({row:e})=>[l(x(e.isShow?"是":"否"),1)]),menuType:s(({row:e})=>[e.menuType===1?(o(),i(S,{key:0,type:"normal",bordered:""},{default:s(()=>[l(" 菜单 ")]),_:1})):(o(),i(S,{key:1,type:"warm",bordered:""},{default:s(()=>[l(" 按钮 ")]),_:1}))]),_:1},8,["selected-keys","height","default-expand-all","loading","columns","data-source","default-toolbar"])]),_:1},8,["title"]),k(ee,{visible:f.value,"onUpdate:visible":t[3]||(t[3]=e=>f.value=e),"is-sub":C.value,"menu-data":_.value,onQueryTableData:v},null,8,["visible","is-sub","menu-data"])]),_:1})}}});export{xe as default};
