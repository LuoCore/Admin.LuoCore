import{r as K}from"./index-8a034af5.js";import{d as V,B as Z,C as A,r as a,D as j,E as w,a as n,c as l,w as r,b as m,t as k,G as i,e as u,Z as f,aB as H,A as J,aC as O}from"./index-6acea29e.js";import{x as Q}from"./index-1a1c2b81.js";import{_ as W}from"./index-af09c493.js";import X from"./RoleSearchForm-8a716959.js";import{u as Y}from"./useConfirm-290a5cff.js";import{_ as ee}from"./RoleEditDialog.vue_vue_type_script_setup_true_lang-4cd41622.js";import{_ as te}from"./RoleMenuEdit.vue_vue_type_script_setup_true_lang-6838ab26.js";import"./index2-cd0a4242.js";import"./index2-7dd06883.js";import"./index-d34f111a.js";import"./index-3f021a5e.js";import"./index2-1f812a98.js";import"./index2-b5b6ddb4.js";import"./index2-8b56d984.js";const oe=[{title:"",type:"checkbox",width:"50px",fixed:"left"},{key:"roleId",title:"角色Id",align:"center"},{key:"roleName",title:"角色名",align:"center"},{key:"operator",title:"操作",align:"center",width:"180px",customSlot:"operator",fixed:"right"}],be=V({name:"system_role",__name:"index",setup(se){var $;const{loading:P,setLoading:p}=Z(!0),R=(($=A().meta)==null?void 0:$.title)||"",b=a(),C=a([]),x=a([]),B=a(["filter"]),v=a({total:0,limit:10,current:1,showRefresh:!0}),y=a(!1),g=a(!1),h=a(),D=a(0),I=a([]),c=j({currentPageNum:1,pageSize:10,requestData:{}});p(!1);const E=()=>{b.value.resetForm()};async function z(o){p(!0);try{const e=await O(o);if(!e||!e.responseData)return;o&&o.currentPageNum&&(v.value.current=o.currentPageNum),v.value.total=Number(e.pageCount),C.value=e.responseData}catch{}finally{p(!1)}}function F(o){c.currentPageNum=o.current,c.pageSize=o.limit,z(c)}function _(){z(c)}function N(o){h.value=o,y.value=!0}function M(o){D.value=o.roleId,I.value=o.menuIds,g.value=!0}function T(o){if(!o){f.msg("请选择角色",{icon:2});return}Y("确定要删除这条数据吗？",async e=>{try{const t=await H(o.roleId);if(!t||!t.isSuccess){f.msg((t==null?void 0:t.message)||"操作失败",{icon:2});return}f.msg((t==null?void 0:t.message)||"操作成功",{icon:1}),_(),f.close(e)}catch(t){f.msg(t.message,{icon:2})}})}return(o,e)=>{const t=J,L=W,U=Q,q=K,d=w("any-permission"),G=w("permission");return n(),l(q,{fluid:"true",class:"z-container"},{default:r(()=>[m(U,{title:k(R)},{default:r(()=>[m(X,{ref_key:"searchForm",ref:b,"form-model":c.requestData},null,8,["form-model"]),m(L,{id:"id","selected-keys":x.value,"onUpdate:selectedKeys":e[3]||(e[3]=s=>x.value=s),loading:k(P),page:v.value,columns:k(oe),"data-source":C.value,"default-toolbar":B.value,"max-height":"450px",onChange:F},{toolbar:r(()=>[i((n(),l(t,{size:"md",type:"normal",onClick:e[0]||(e[0]=s=>_())},{default:r(()=>[u(" 查询 ")]),_:1})),[[d,["sys:role:add","sys:role:save"]]]),i((n(),l(t,{size:"md",onClick:e[1]||(e[1]=s=>E()),border:"blue"},{default:r(()=>[u(" 重置 ")]),_:1})),[[d,["sys:role:add","sys:role:save"]]]),i((n(),l(t,{size:"sm",type:"primary",onClick:e[2]||(e[2]=s=>N())},{default:r(()=>[u(" 新增 ")]),_:1})),[[d,["sys:role:add","sys:role:save"]]])]),operator:r(({row:s})=>[i((n(),l(t,{size:"xs",type:"primary",onClick:S=>N(s)},{default:r(()=>[u(" 修改 ")]),_:2},1032,["onClick"])),[[d,["sys:role:edit","sys:role:update"]]]),i((n(),l(t,{size:"xs",type:"danger",onClick:S=>T(s)},{default:r(()=>[u(" 删除 ")]),_:2},1032,["onClick"])),[[G,"sys:role:delete"]]),i((n(),l(t,{size:"xs",type:"normal",onClick:S=>M(s)},{default:r(()=>[u(" 分配权限 ")]),_:2},1032,["onClick"])),[[d,["sys:role:edit","sys:role:update"]]])]),_:1},8,["selected-keys","loading","page","columns","data-source","default-toolbar"])]),_:1},8,["title"]),m(ee,{visible:y.value,"onUpdate:visible":e[4]||(e[4]=s=>y.value=s),data:h.value},null,8,["visible","data"]),m(te,{visible:g.value,"onUpdate:visible":e[5]||(e[5]=s=>g.value=s),"role-id":D.value,"checked-menu-ids":I.value,onDone:_},null,8,["visible","role-id","checked-menu-ids"])]),_:1})}}});export{be as default};
