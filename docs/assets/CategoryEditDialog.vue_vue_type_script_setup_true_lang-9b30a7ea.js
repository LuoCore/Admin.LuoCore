import{d as U,k as M,r as u,D as T,z as q,a as F,c as O,w as i,b as s,Z as n,N as S,M as $,V as j,O as E,P as G}from"./index-a5a9e71e.js";import{C as Z}from"./index-5dca1a49.js";import{V as z}from"./index-7524af9d.js";import{a as P,d as A}from"./Blogs-9145909e.js";const Q=U({__name:"CategoryEditDialog",props:{visible:{type:Boolean},data:{}},emits:["done","update:visible"],setup(v,{emit:V}){const c=v,m=M({get(){return c.visible},set(e){V("update:visible",e)}}),d=u(),p=u(!1),y={categoryId:0,categoryName:"",categoryDescription:"",parentId:0,isDisable:!1},o=T({...y}),h=u({categoryName:{type:"string",required:!0,message:"角色名不能为空"},categoryDescription:{type:"string",required:!0,message:"角色编码不能为空"}}),f=u([]);function _(e){const a={id:e.categoryId,title:e.categoryName,field:e.parentId,children:void 0};if(e.childrenCategorys&&e.childrenCategorys.length>0){const t=e.childrenCategorys.map(r=>_(r));a.children=t}return a}async function w(){try{const e=await P();if(e){if(!e.isSuccess||!e.responseData){n.msg(`获取分类列表失败:${e.message}`,{icon:2});return}}else{n.msg("获取分类列表失败",{icon:2});return}f.value=[{id:0,title:"父级",field:"",children:[]}],e.responseData.map(a=>{f.value[0].children.push(_(a))})}catch(e){n.msg(e.message,{icon:2})}}function D(){w(),c.data?(Object.assign(o,c.data),p.value=!0):(Object.assign(o,y),p.value=!1)}function g(){var e;d.value.reset(),(e=d.value)==null||e.clearValidate(),m.value=!1}async function x(e,a){try{const t=await A(e);if(!t||!t.isSuccess){n.msg((t==null?void 0:t.message)||"操作失败",{icon:2});return}n.msg((t==null?void 0:t.message)||"操作成功",{icon:1}),n.close(a),g()}catch(t){n.close(a),n.msg(t.message,{icon:2})}}function C(){d.value.validate((e,a,t)=>{e&&n.msg("正在提交数据...",{icon:16,time:0,shade:!0,success:async r=>{await x(a,r)}})})}return q(()=>c.visible,e=>{e&&D()}),(e,a)=>{const t=z,r=S,k=$,b=Z,B=j,I=E,N=G;return F(),O(N,{modelValue:m.value,"onUpdate:modelValue":a[5]||(a[5]=l=>m.value=l),area:"500px",title:p.value?"编辑":"新增","shade-close":!1,move:!0,maxmin:!0,btn:[{text:"提交",callback:()=>C()},{text:"关闭",callback:()=>g()}],onClose:g},{default:i(()=>[s(I,{ref_key:"refForm",ref:d,model:o,rules:h.value,style:{padding:"10px"}},{default:i(()=>[s(r,{label:"上级菜单",prop:"parentId",required:""},{default:i(()=>[s(t,{modelValue:o.parentId,"onUpdate:modelValue":a[0]||(a[0]=l=>o.parentId=l),"allow-clear":!0,search:!0,data:f.value,style:{width:"100%"}},null,8,["modelValue","data"])]),_:1}),s(r,{label:"名称",prop:"code"},{default:i(()=>[s(k,{modelValue:o.categoryName,"onUpdate:modelValue":a[1]||(a[1]=l=>o.categoryName=l),placeholder:"请填写","allow-clear":""},null,8,["modelValue"])]),_:1}),s(r,{label:"描述",prop:"describe"},{default:i(()=>[s(b,{modelValue:o.categoryDescription,"onUpdate:modelValue":a[2]||(a[2]=l=>o.categoryDescription=l),placeholder:"请填写","allow-clear":""},null,8,["modelValue"])]),_:1}),s(r,{label:"描述",prop:"describe"},{default:i(()=>[s(b,{modelValue:o.categoryDescription,"onUpdate:modelValue":a[3]||(a[3]=l=>o.categoryDescription=l),placeholder:"请填写","allow-clear":""},null,8,["modelValue"])]),_:1}),s(r,{label:"是否禁用",prop:"switch",mode:"inline"},{default:i(()=>[s(B,{modelValue:o.isDisable,"onUpdate:modelValue":a[4]||(a[4]=l=>o.isDisable=l),"onswitch-text":"是","unswitch-text":"否"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title","btn"])}}});export{Q as _};
