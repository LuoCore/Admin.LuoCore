import{d as O,k as S,r as f,D as E,z as j,a as c,c as _,w as s,b as o,q as L,e as Z,l as $,F as z,H as G,Z as d,I as H,J,g as K,aq as P,T as R,K as W,M as Q}from"./index-c7b5f3e4.js";import{a as X,u as Y}from"./index-238ce155.js";/* empty css              *//* empty css              */import{x as ee,A as le}from"./index-08db7ed5.js";/* empty css              */import{j as ae,k as oe}from"./Basic-6a32a728.js";import{g as te}from"./index2-c0cbaf67.js";const fe=O({__name:"UserEditDialog",props:{visible:{type:Boolean},formData:{}},emits:["done","update:visible"],setup(N,{emit:y}){const u=N,b=S({get(){return u.visible},set(t){y("update:visible",t)}}),i=f(),m=f(!1),v={userId:0,userName:"",nickname:"",phoneMobileNumber:"",phoneTeleNumber:"",emailAddress:"",roleIds:[],gender:0,birthday:"",isDisable:!1},a=E({...v}),k=f({userName:[{type:"string",required:!0,message:"账号不能为空"},{asyncValidator:async(t,e)=>{if(!e)return Promise.resolve()}}],warehouseId:{type:"number",required:!0,message:"请选择仓库",validator(t,e,r,n,w){e<=0&&r(new Error("请选择仓库"))}},email:{type:"email"}}),g=f([]);async function U(){const t=await ae();if(!t||!t.isSuccess){d.msg((t==null?void 0:t.message)||"获取角色失败",{icon:2});return}g.value=t.responseData.map(e=>({label:e.roleName,value:e.roleId}))}function I(){U(),u.formData?(Object.assign(a,u.formData),m.value=!0,u.formData.roleInfos&&(a.roleIds=u.formData.roleInfos.map(t=>t.roleId))):(Object.assign(a,v),m.value=!1)}j(()=>u.visible,(t,e)=>{t&&I()});function V(){var t;b.value=!1,i.value.reset(),(t=i.value)==null||t.clearValidate()}async function x(t,e){try{const r=await oe(t);if(!r||!r.isSuccess){d.confirm(r.message||"编辑用户信息失败",{icon:2});return}d.msg(r.message||"操作成功",{icon:1}),y("done"),V()}catch(r){d.msg(r.message,{icon:2})}finally{d.close(e)}}function q(){i.value.validate((t,e,r)=>{t&&d.msg("正在提交数据...",{icon:16,time:0,shade:!0,success:async n=>{await x(e,n)}})})}return(t,e)=>{const r=H,n=J,w=K,T=P,h=ee,A=le,D=X,p=te,B=R,C=Y,F=W,M=Q;return c(),_(M,{modelValue:b.value,"onUpdate:modelValue":e[12]||(e[12]=l=>b.value=l),area:"700px",title:m.value?"编辑":"新增","shade-close":!1,move:!0,maxmin:!0,btn:[{text:"提交",callback:()=>q()},{text:"关闭",callback:()=>V()}],onClose:V},{default:s(()=>[o(F,{ref_key:"refForm",ref:i,model:a,rules:k.value,style:{padding:"10px"}},{default:s(()=>[o(C,null,{default:s(()=>[o(D,{md:12},{default:s(()=>[o(n,{label:"账号",prop:"userName",required:""},{default:s(()=>[o(r,{modelValue:a.userName,"onUpdate:modelValue":e[0]||(e[0]=l=>a.userName=l),placeholder:"请填写",disabled:m.value,"allow-clear":""},null,8,["modelValue","disabled"])]),_:1}),o(n,{label:"昵称",prop:"nickname",required:""},{default:s(()=>[o(r,{modelValue:a.nickname,"onUpdate:modelValue":e[1]||(e[1]=l=>a.nickname=l),placeholder:"请填写","allow-clear":"",autocomplete:"off"},null,8,["modelValue"])]),_:1}),m.value?L("",!0):(c(),_(n,{key:0,label:"密码",prop:"password",rules:[{type:"string",required:!0,message:"密码不能为空"},{type:"string",min:6,max:10,message:"密码长度6-10"}],required:""},{default:s(()=>[o(r,{modelValue:a.password,"onUpdate:modelValue":e[2]||(e[2]=l=>a.password=l),type:"password",placeholder:"请填写",password:"","allow-clear":"",autocomplete:"off"},null,8,["modelValue"])]),_:1})),o(n,{label:"邮箱",prop:"emailAddress"},{default:s(()=>[o(r,{modelValue:a.emailAddress,"onUpdate:modelValue":e[3]||(e[3]=l=>a.emailAddress=l),placeholder:"请填写","allow-clear":""},null,8,["modelValue"])]),_:1}),o(n,{prop:"roleIds"},{label:s(()=>[Z(" 角色 "),o(T,{content:"不选则解绑该用户原有的角色"},{default:s(()=>[o(w,{type:"layui-icon-about"})]),_:1})]),default:s(()=>[o(A,{modelValue:a.roleIds,"onUpdate:modelValue":e[4]||(e[4]=l=>a.roleIds=l),placeholder:"请选择",multiple:"","allow-clear":"","min-collapsed-num":1,style:{width:"100%"}},{default:s(()=>[(c(!0),$(z,null,G(g.value,l=>(c(),_(h,{key:l.value,value:l.value,label:l.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),o(D,{md:12},{default:s(()=>[o(n,{label:"性别",prop:"gender",required:""},{default:s(()=>[o(p,{modelValue:a.gender,"onUpdate:modelValue":e[5]||(e[5]=l=>a.gender=l),name:"gender",value:1,label:"男"},null,8,["modelValue"]),o(p,{modelValue:a.gender,"onUpdate:modelValue":e[6]||(e[6]=l=>a.gender=l),name:"gender",value:0,label:"女"},null,8,["modelValue"])]),_:1}),o(n,{label:"是否禁用",prop:"isDisable"},{default:s(()=>[o(p,{modelValue:a.isDisable,"onUpdate:modelValue":e[7]||(e[7]=l=>a.isDisable=l),name:"isDisable",value:!0,label:"是"},null,8,["modelValue"]),o(p,{modelValue:a.isDisable,"onUpdate:modelValue":e[8]||(e[8]=l=>a.isDisable=l),name:"isDisable",value:!1,label:"否"},null,8,["modelValue"])]),_:1}),o(n,{label:"手机号码",prop:"phoneMobileNumber"},{default:s(()=>[o(r,{modelValue:a.phoneMobileNumber,"onUpdate:modelValue":e[9]||(e[9]=l=>a.phoneMobileNumber=l),placeholder:"请填写","allow-clear":""},null,8,["modelValue"])]),_:1}),o(n,{label:"电话号码",prop:"phoneTeleNumber"},{default:s(()=>[o(r,{modelValue:a.phoneTeleNumber,"onUpdate:modelValue":e[10]||(e[10]=l=>a.phoneTeleNumber=l),placeholder:"请填写","allow-clear":""},null,8,["modelValue"])]),_:1}),o(n,{label:"生日",prop:"birthday"},{default:s(()=>[o(B,{modelValue:a.birthday,"onUpdate:modelValue":e[11]||(e[11]=l=>a.birthday=l),placeholder:"请选择","allow-clear":"",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title","btn"])}}});export{fe as _};
