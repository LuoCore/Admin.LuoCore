import{r as O}from"./index-18f2e450.js";import{j as Q,d as R,v as J,k as W,t as i,a as r,l,s as X,n as F,c as n,a8 as Y,B as ee,C as te,r as m,D as ae,E as L,w as a,b as p,G as _,e as y,f as z,F as se,H as re,x as N,I,aK as ie,Z as h,aL as ne,A as oe,V as le}from"./index-53adf29b.js";import{x as ce}from"./index-f2193864.js";import{_ as ue}from"./index-e2d03d9a.js";/* empty css              */import de from"./UserSearchForm-fe0e8bf2.js";import{_ as me}from"./UserEditDialog.vue_vue_type_script_setup_true_lang-8984f7b7.js";import{u as pe}from"./useConfirm-a852b310.js";import{$ as ye}from"./index2-79d7d27b.js";import"./index2-5d5b79b3.js";import"./index2-21289748.js";import"./index-0c2b8664.js";import"./index-9fd596c5.js";import"./index2-31d7a95a.js";/* empty css              *//* empty css              *//* empty css              */const fe=["src","alt"],ge=Q(R({name:"LayAvatar",props:{src:null,size:{default:"md"},radius:{type:Boolean,default:!1},icon:{default:"layui-icon-username"},alt:null},setup(c){const f=c,g=J(),v=W(()=>["layui-avatar",f.radius?"layui-avatar-radius":"",f.size?`layui-avatar-${f.size}`:""]);return(k,x)=>i(g).default?(r(),l("span",{key:0,class:F(i(v))},[X(k.$slots,"default")],2)):(r(),l("span",{key:1,class:F(i(v))},[c.src?(r(),l("img",{key:0,src:c.src,alt:c.alt},null,8,fe)):(r(),n(i(Y),{key:1,type:c.icon},null,8,["type"]))],2))}}));const _e=[{key:"userId",title:"用户Id",width:"80px",fixed:"left",sort:"desc"},{key:"userName",title:"用户名称",width:"100px"},{key:"roleInfos",title:"角色",align:"center",width:"100px",customSlot:"roles"},{key:"nickname",title:"昵称",align:"center",width:"100px"},{key:"phoneTeleNumber",title:"电话号码",align:"center",width:"150px"},{key:"phoneMobileNumber",title:"手机号码",align:"center",width:"150px"},{key:"emailAddress",title:"电子邮箱",align:"center",width:"200px"},{key:"gender",title:"性别",align:"center",width:"90px",customSlot:"gender"},{key:"birthday",title:"生日",align:"center",width:"180px",customSlot:"birthday"},{key:"createTime",title:"创建时间",align:"center",width:"180px",customSlot:"createTime"},{key:"isDisable",title:"禁用",align:"center",width:"90px",customSlot:"isDisable"},{key:"operator",title:"操作",align:"left",customSlot:"operator",fixed:"right",width:"200px"}],he={style:{display:"grid"}},ve={key:0},ke={key:1},xe={key:2},Ve=R({__name:"index",setup(c){var M;const{loading:f,setLoading:g}=ee(!0),k=((M=te().meta)==null?void 0:M.title)||"",x=m(),C=m([]),P=m([]),V=m(["filter"]),w=ae({current:1,limit:10,total:0,showRefresh:!0}),b=m(!1),T=m(),u={currentPageNum:1,pageSize:10};g(!1);function S(s){const e={requestData:s,pageSize:u.pageSize,currentPageNum:u.currentPageNum};$(e)}async function $(s){g(!0);try{const e=await ie(s);if(!e||!e.isSuccess)return;s&&s.currentPageNum&&(w.current=s.currentPageNum),w.total=e.pageCount,C.value=e.responseData}catch{}finally{g(!1)}}function A(s){const e=x.value.formModel;u.pageSize=s.limit,u.currentPageNum=s.current;const o={requestData:e,pageSize:u.pageSize,currentPageNum:u.currentPageNum};$(o)}function E(s){if(!s){h.msg("请选择用户",{icon:2,time:2e3});return}pe("确定要删除这条数据吗？",async()=>{try{const e=await ne(s);if(!e||!e.isSuccess){h.confirm(e.message||"操作失败",{icon:2});return}h.msg(e.message||"操作成功",{icon:1}),S()}catch(e){h.msg(e.message,{icon:2})}finally{}})}function B(s){T.value=s,b.value=!0}return(s,e)=>{const o=oe,H=ge,K=ye,q=le,G=ue,Z=ce,j=O,D=L("any-permission"),U=L("permission");return r(),n(j,{fluid:"true",class:"z-container"},{default:a(()=>[p(Z,{title:i(k)},{default:a(()=>[p(de,{ref_key:"searchForm",ref:x,onOnSearch:S},null,512),p(G,{id:"userId","selected-keys":P.value,"onUpdate:selectedKeys":e[1]||(e[1]=t=>P.value=t),loading:i(f),page:w,columns:i(_e),"data-source":C.value,"default-toolbar":V.value,"auto-cols-width":!0,"max-height":"450px",onChange:A},{toolbar:a(()=>[_((r(),n(o,{size:"sm",type:"primary",onClick:e[0]||(e[0]=t=>B())},{default:a(()=>[y(" 新增 ")]),_:1})),[[D,["sys:user:add","sys:user:save"]]]),_((r(),n(o,{size:"sm",type:"danger"},{default:a(()=>[y(" 删除 ")]),_:1})),[[U,"sys:user:delete"]])]),operator:a(({row:t})=>[_((r(),n(o,{size:"xs",type:"primary",onClick:d=>B(t)},{default:a(()=>[y(" 修改 ")]),_:2},1032,["onClick"])),[[D,["sys:user:edit","sys:user:update"]]]),_((r(),n(o,{size:"xs",type:"danger",onClick:d=>E(t.userId)},{default:a(()=>[y(" 删除 ")]),_:2},1032,["onClick"])),[[U,"sys:user:delete"]]),_((r(),n(o,{size:"xs"},{default:a(()=>[y(" 重置密码 ")]),_:1})),[[D,["sys:user:edit","sys:user:update"]]])]),avatar:a(({row:t})=>[p(H,{src:t.avatar,radius:""},null,8,["src"])]),roles:a(({row:t})=>[z("div",he,[(r(!0),l(se,null,re(t.roleInfos,d=>(r(),n(K,{key:d.roleId,"max-width":"100px",style:{margin:"2px"}},{default:a(()=>[y(N((d==null?void 0:d.roleName)||"无"),1)]),_:2},1024))),128))])]),gender:a(({row:t})=>[t.gender==1?(r(),l("span",ve,"男")):t.gender==0?(r(),l("span",ke,"女")):(r(),l("span",xe,"未知"))]),createTime:a(({row:t})=>[z("span",null,N(i(I)(t.createTime,"yyyy-M-d H:m:s")),1)]),birthday:a(({row:t})=>[z("span",null,N(i(I)(t.birthday,"yyyy-M-d H:m:s")),1)]),isDisable:a(({row:t})=>[p(q,{"model-value":t.isDisable,"onswitch-text":"是","onswitch-value":!0,"unswitch-text":"否","unswitch-value":!1},null,8,["model-value"])]),_:1},8,["selected-keys","loading","page","columns","data-source","default-toolbar"])]),_:1},8,["title"]),p(me,{visible:b.value,"onUpdate:visible":e[2]||(e[2]=t=>b.value=t),data:T.value,onDone:S},null,8,["visible","data"])]),_:1})}}});export{Ve as default};
