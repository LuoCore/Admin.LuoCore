import{r as G}from"./index-44c9ce80.js";import{d as K,C as q,B as P,r,o as W,E as M,a as o,c as i,w as t,b as v,t as k,G as c,e as l,x as h,f as j,q as F,P as u,A as J,g as O}from"./index-2aad6dfc.js";import{x as Q}from"./index-8a3edce5.js";import{_ as R}from"./index-5c14c7e5.js";/* empty css              */import{u as X}from"./useConfirm-7a37fa3c.js";import Y from"./MenuEditDialog-717afd39.js";import{e as Z,f as ee}from"./Basic-2ba83306.js";import{$ as te}from"./index2-a6139534.js";import"./index2-b6cd40cb.js";import"./index2-f922c431.js";import"./index-703526c2.js";/* empty css              *//* empty css              */import"./index-4a1d38e6.js";import"./index2-daa80bda.js";import"./index2-29dd889e.js";const ne=[{key:"menuId",title:"菜单Id"},{key:"menuName",title:"菜单名称",customSlot:"menuName"},{key:"menuUrl",title:"路由地址",ellipsisTooltip:!0},{key:"sortId",title:"排序",width:"80px",align:"center"},{key:"menuType",title:"类型",width:"150px",align:"center",customSlot:"menuType"},{key:"isDisable",title:"是否禁用",width:"50px",align:"center",customSlot:"isDisable"},{key:"operator",title:"操作",align:"left",customSlot:"operator",fixed:"right",width:"200px"}],be=K({__name:"index",setup(se){var S;const{loading:N,setLoading:y}=q(!0),$=((S=P().meta)==null?void 0:S.title)||"",x=r([]),b=r([]),m=r(!1),E=r(["filter"]),f=r(!1),C=r(),D=r(0),w=r(window.innerHeight-300);W(()=>{window.addEventListener("resize",B)});function B(){w.value=window.innerHeight-300}y(!1);async function _(){y(!0);try{const s=await Z();if(!s||!s.isSuccess)return;x.value=s.responseData}catch(s){console.log(s)}finally{y(!1)}}function H(s){if(!s){u.msg("请选择菜单",{icon:2});return}X("确定要删除这条数据吗？",async n=>{try{u.msg("正在删除数据...",{icon:16,time:0,shade:!0,success:async a=>{var d=await ee(s);d.isSuccess?(u.msg("操作成功",{icon:1}),_()):u.msg("操作失败！"+(d==null?void 0:d.message),{icon:2}),u.close(a)}})}catch(a){u.msg(a.message,{icon:2})}u.close(n)})}function V(){m.value=!m.value}function g(s,n){C.value=s,D.value=n??0,f.value=!0}return(s,n)=>{const a=J,d=O,I=te,L=R,U=Q,A=G,p=M("any-permission"),T=M("permission");return o(),i(A,{fluid:"true",class:"z-container"},{default:t(()=>[v(U,{title:k($)},{default:t(()=>[v(L,{id:"menuId","selected-keys":b.value,"onUpdate:selectedKeys":n[2]||(n[2]=e=>b.value=e),"children-column-name":"childrenMenus",height:`${w.value}px`,"default-expand-all":m.value,loading:k(N),columns:k(ne),"data-source":x.value,"default-toolbar":E.value,"expand-index":1},{toolbar:t(()=>[c((o(),i(a,{size:"lg",type:"normal",onClick:n[0]||(n[0]=e=>_())},{default:t(()=>[l(" 查询 ")]),_:1})),[[p,["sys:user:add","sys:user:save"]]]),c((o(),i(a,{size:"lg",type:"primary",onClick:n[1]||(n[1]=e=>g())},{default:t(()=>[l(" 新增 ")]),_:1})),[[p,["sys:user:add","sys:user:save"]]]),c((o(),i(a,{size:"md",type:"danger",onClick:V},{default:t(()=>[l(h(m.value?"全部收起":"全部展开"),1)]),_:1})),[[T,"sys:user:delete"]])]),operator:t(({row:e})=>[c((o(),i(a,{size:"sm",type:"primary",onClick:z=>g(e,e.menuId)},{default:t(()=>[l(" 新增子级 ")]),_:2},1032,["onClick"])),[[p,["sys:user:add","sys:user:save"]]]),c((o(),i(a,{size:"sm",onClick:z=>g(e)},{default:t(()=>[l(" 修改 ")]),_:2},1032,["onClick"])),[[p,["sys:user:edit","sys:user:update"]]]),c((o(),i(a,{size:"sm",type:"danger",onClick:z=>H(e.menuId)},{default:t(()=>[l(" 删除 ")]),_:2},1032,["onClick"])),[[T,"sys:user:delete"]])]),menuName:t(({row:e})=>[j("span",null,[e.menuIcon?(o(),i(d,{key:0,type:e.menuIcon,style:{"margin-right":"4px"}},null,8,["type"])):F("",!0),l(" "+h(e.menuName),1)])]),isDisable:t(({row:e})=>[l(h(e.isShow?"是":"否"),1)]),menuType:t(({row:e})=>[e.menuType===1?(o(),i(I,{key:0,type:"normal",bordered:""},{default:t(()=>[l(" 菜单 ")]),_:1})):(o(),i(I,{key:1,type:"warm",bordered:""},{default:t(()=>[l(" 按钮 ")]),_:1}))]),_:1},8,["selected-keys","height","default-expand-all","loading","columns","data-source","default-toolbar"])]),_:1},8,["title"]),v(Y,{visible:f.value,"onUpdate:visible":n[3]||(n[3]=e=>f.value=e),"form-data":C.value,"parent-menu-id":D.value,onDone:_},null,8,["visible","form-data","parent-menu-id"])]),_:1})}}});export{be as default};
